<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
    <meta charset="utf-8" />
    <meta http-equiv="X-UA-Compatible" content="IE=edge" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
      <link rel="shortcut icon" href="../img/favicon.ico" />
    <title>F-statistic candidate signal search - TDFstat</title>
    <link rel="stylesheet" href="../css/theme.css" />
    <link rel="stylesheet" href="../css/theme_extra.css" />
        <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/styles/github.min.css" />
        <link href="../extra.css" rel="stylesheet" />
    
      <script>
        // Current page data
        var mkdocs_page_name = "F-statistic candidate signal search";
        var mkdocs_page_input_path = "search_for_candidates.md";
        var mkdocs_page_url = null;
      </script>
    
    <!--[if lt IE 9]>
      <script src="../js/html5shiv.min.js"></script>
    <![endif]-->
      <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/highlight.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/yaml.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/plaintext.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/python.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/cpp.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/bash.min.js"></script>
        <script src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/11.8.0/languages/shell.min.js"></script>
      <script>hljs.highlightAll();</script> 
</head>

<body class="wy-body-for-nav" role="document">

  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side stickynav">
    <div class="wy-side-scroll">
      <div class="wy-side-nav-search">
          <a href=".." class="icon icon-home"> TDFstat
        </a><div role="search">
  <form id ="rtd-search-form" class="wy-form" action="../search.html" method="get">
      <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" title="Type search term here" />
  </form>
</div>
      </div>

      <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <ul>
                <li class="toctree-l1"><a class="reference internal" href="..">Home</a>
                </li>
              </ul>
              <p class="caption"><span class="caption-text">Pipeline description</span></p>
              <ul class="current">
                  <li class="toctree-l1"><a class="reference internal" href="../input_data/">Input data generation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../grid_generation/">Grid generation</a>
                  </li>
                  <li class="toctree-l1 current"><a class="reference internal current" href="#">F-statistic candidate signal search</a>
    <ul class="current">
    <li class="toctree-l2"><a class="reference internal" href="#algorithm-flowchart">Algorithm flowchart</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#prerequisites">Prerequisites</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#compilation">Compilation</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#full-list-of-switches">Full list of switches</a>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#example">Example</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#network-of-detectors">Network of detectors</a>
    </li>
        </ul>
    </li>
    <li class="toctree-l2"><a class="reference internal" href="#output-files">Output files</a>
        <ul>
    <li class="toctree-l3"><a class="reference internal" href="#auxiliary-output-files">Auxiliary output files</a>
    </li>
        </ul>
    </li>
    </ul>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../coincidences/">Coincidences between candidates</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../fap_coincidences/">False alarm probablity of conicidences</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../followup/">Followup of interesting outliers</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../sensitivity_upper_limits/">Sensitivity upper limits</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../fisher/">Fisher matrix calculation</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../simple_example/">Pipeline: a minimal example</a>
                  </li>
                  <li class="toctree-l1"><a class="reference internal" href="../articles/">Documents and publications</a>
                  </li>
              </ul>
              <p class="caption"><span class="caption-text">Docs howto</span></p>
              <ul>
                  <li class="toctree-l1"><a class="reference internal" href="../mkdocs_howto/">Docs howto</a>
                  </li>
              </ul>
      </div>
    </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">
      <nav class="wy-nav-top" role="navigation" aria-label="Mobile navigation menu">
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="..">TDFstat</a>
        
      </nav>
      <div class="wy-nav-content">
        <div class="rst-content"><div role="navigation" aria-label="breadcrumbs navigation">
  <ul class="wy-breadcrumbs">
    <li><a href=".." class="icon icon-home" aria-label="Docs"></a></li>
          <li class="breadcrumb-item">Pipeline description</li>
      <li class="breadcrumb-item active">F-statistic candidate signal search</li>
    <li class="wy-breadcrumbs-aside">
    </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
            <div class="section" itemprop="articleBody">
              
                <h1 id="f-statistic-candidate-signal-search">F-statistic candidate signal search</h1>
<p>Production serial code for a network of detectors is available at <a href="https://github.com/mbejger/polgraw-allsky/tree/master/search/network/src-cpu">here</a>. <code>OpenMP</code> version is at <a href="https://github.com/mbejger/polgraw-allsky/tree/master/search/network/src-openmp">this location</a>. To get the whole pipeline, run <code>git clone https://github.com/mbejger/polgraw-allsky.git</code>. </p>
<h2 id="algorithm-flowchart">Algorithm flowchart</h2>
<p><img alt="Code flowchart" src="../img/flowchart.png" /></p>
<h2 id="prerequisites">Prerequisites</h2>
<p>The code is written in standard <code>C</code>. <a href="http://www.gnu.org/software/gsl/">GNU Scientific Library (GSL)</a> and the <a href="http://www.fftw.org">FFTW library</a> (version 3.0 or later) are needed to run the code. <a href="http://www.gnu.org/software/libc/manual/html_node/Accessing-Directories.html#Accessing-Directories">GNU struct dirent</a> objects are used to read the directories. </p>
<p>Optionally, <a href="http://shibatch.sourceforge.net">SLEEF</a> or <a href="http://www.yeppp.info">YEPPP!</a>, libraries for high-performance computing that are optimized for speed are used to evaluate the trigonometric functions in the search code. These libraries are ported with the source code and are located in <code>src/lib</code>. The choice which of these libraries to use has to be made at compilation time by modifying the <code>Makefile</code>. </p>
<h2 id="compilation">Compilation</h2>
<p>Run  <code>make gwsearch-cpu</code> or <code>make</code> in <code>search/network/src-cpu</code>, resulting  binary is called <code>gwsearch-cpu</code> (this is the default <code>C</code> version not-optimized with <code>openMP</code>; for the <code>openMP</code> version see the <code>search/network/src-openmp</code> directory). Modify the <code>Makefile</code> to fit your system. By default the <code>YEPPP!</code> library is selected. </p>
<h2 id="full-list-of-switches">Full list of switches</h2>
<p>For the full list of options, type</p>
<pre><code class="language-bash">% ./gwsearch-cpu --help 
</code></pre>
<table>
<thead>
<tr>
<th>Switch</th>
<th style="text-align: left;">Description</th>
</tr>
</thead>
<tbody>
<tr>
<td>-data</td>
<td style="text-align: left;">Data directory (default is <code>.</code>)</td>
</tr>
<tr>
<td>-output</td>
<td style="text-align: left;">Output directory (default is <code>./candidates</code>)</td>
</tr>
<tr>
<td>-ident</td>
<td style="text-align: left;">Frame number</td>
</tr>
<tr>
<td>-band</td>
<td style="text-align: left;">Band number</td>
</tr>
<tr>
<td>-label</td>
<td style="text-align: left;">Custom label for the input and output files</td>
</tr>
<tr>
<td>-range</td>
<td style="text-align: left;">Use file with grid range or pulsar position</td>
</tr>
<tr>
<td>-getrange</td>
<td style="text-align: left;">Write grid ranges &amp; save fft wisdom &amp; exit (ignore -r)</td>
</tr>
<tr>
<td>-cwd</td>
<td style="text-align: left;">Change to directory <code>&lt;dir&gt;</code></td>
</tr>
<tr>
<td>-threshold</td>
<td style="text-align: left;">Threshold for the <span class="arithmatex"><span class="MathJax_Preview">\mathcal{F}</span><script type="math/tex">\mathcal{F}</script></span>-statistic (default is <code>20</code>)</td>
</tr>
<tr>
<td>-hemisphere</td>
<td style="text-align: left;">Hemisphere (default is 0 - does both)</td>
</tr>
<tr>
<td>-fpo</td>
<td style="text-align: left;">Reference band frequency <code>fpo</code> value</td>
</tr>
<tr>
<td>-dt</td>
<td style="text-align: left;">Data sampling time dt (default value: <code>0.5</code>)</td>
</tr>
<tr>
<td>-usedet</td>
<td style="text-align: left;">Use only detectors from string (default is <code>use all available</code>)</td>
</tr>
<tr>
<td>-addsig</td>
<td style="text-align: left;">Add signal with parameters from <code>&lt;file&gt;</code></td>
</tr>
<tr>
<td>-narrowdown</td>
<td style="text-align: left;">Narrow-down the frequency band (range <code>[0, 0.5] +- around center</code>)</td>
</tr>
</tbody>
</table>
<p>Also: </p>
<table>
<thead>
<tr>
<th></th>
<th style="text-align: left;"></th>
</tr>
</thead>
<tbody>
<tr>
<td>--whitenoise</td>
<td style="text-align: left;">White Gaussian noise assumed</td>
</tr>
<tr>
<td>--nospindown</td>
<td style="text-align: left;">Spindowns neglected</td>
</tr>
<tr>
<td>--nocheckpoint</td>
<td style="text-align: left;">State file will not be created (no checkpointing)</td>
</tr>
<tr>
<td>--help</td>
<td style="text-align: left;">This help</td>
</tr>
</tbody>
</table>
<h2 id="example">Example</h2>
<p>Minimal call to <code>gwsearch-cpu</code> is as follows (code compiled with the <code>GNUSINCOS</code> option): </p>
<pre><code>% ./gwsearch-cpu -data ../../../testdata/2d_0.25 -dt 2 -output . -ident 001 -band 1234 -nod 2  
</code></pre>
<p>where</p>
<ul>
<li><code>data</code> directory is the base directory of input data files,</li>
<li>Sampling time <code>dt</code> is <span class="arithmatex"><span class="MathJax_Preview">2 s</span><script type="math/tex">2 s</script></span>, </li>
<li><code>output</code> directory is a directory to write the output (e.g., in current directory, . ) </li>
<li><code>ident</code> is the number of time frame to be analyzed (<span class="arithmatex"><span class="MathJax_Preview">001</span><script type="math/tex">001</script></span>),</li>
<li><code>nod</code> number of days is <span class="arithmatex"><span class="MathJax_Preview">2</span><script type="math/tex">2</script></span>, </li>
<li><code>band</code> is the number of the frequency band (see the <a href="../polgraw-allsky/input_data">input data structure</a> for details). </li>
</ul>
<h3 id="network-of-detectors">Network of detectors</h3>
<p>Test data frames <span class="arithmatex"><span class="MathJax_Preview">nnn=001-008</span><script type="math/tex">nnn=001-008</script></span> with pure Gaussian noise 2-day time segments with sampling time equal to 2s (<code>xdatc_nnn_1234.bin</code>) for two LIGO detectors H1 and L1 are <a href="https://polgraw.camk.edu.pl/H1L1_2d_0.25.tar.gz">available here</a>. </p>
<p>A sample call is </p>
<pre><code class="language-bash">% LD_LIBRARY_PATH=lib/yeppp-1.0.0/binaries/linux/x86_64 ./gwsearch-cpu \
  -data ../../../testdata/2d_0.25/ \
  -ident 001 \
  -band 1234 \
  -dt 2 \ 
  -nod 2 \ 
  -addsig sig1 \  
  -output . \
  -threshold 14.5 \
  --nocheckpoint
</code></pre>
<p>where the <code>LD_LIBRARY_PATH</code> points to the location of the <code>YEPPP!</code> library. </p>
<p>The program will proceed assuming that </p>
<ul>
<li>the data directory for frame <code>001</code> is located at <code>../../../testdata/2d_0.25/001</code> and contain subdirectories with input data for H1, L1 and/or V1 detectors (all available detectors are used by default; to select specific detectors, use <code>-usedet</code> option), </li>
<li>the grid of parameters files is expected to be in <code>../../../testdata/2d_0.25/001</code>, </li>
<li><code>band</code> equals to <span class="arithmatex"><span class="MathJax_Preview">1234</span><script type="math/tex">1234</script></span>,  </li>
<li>the sampling time <code>dt</code> equals <span class="arithmatex"><span class="MathJax_Preview">2 s</span><script type="math/tex">2 s</script></span>, </li>
<li>number of days <code>nod</code> in <span class="arithmatex"><span class="MathJax_Preview">2</span><script type="math/tex">2</script></span>, </li>
<li>the <code>-addsig</code> option is used to add a software injection to pure noise Gaussian data. The signal's parameters are randomly generated using the <code>sigen</code> code (for more details see the <a href="../polgraw-allsky/pipeline_script">minimal example</a>).  </li>
<li>the threshold for the <span class="arithmatex"><span class="MathJax_Preview">\mathcal{F}</span><script type="math/tex">\mathcal{F}</script></span>-statistic is set to be <span class="arithmatex"><span class="MathJax_Preview">14.5</span><script type="math/tex">14.5</script></span>,</li>
<li><code>-output</code> is the current directory, </li>
<li><code>--nocheckpoint</code> disables the checkpointing (writing the last visited position on the grid to the <code>state</code> file), </li>
</ul>
<h2 id="output-files">Output files</h2>
<p>Binary output files, containing trigger candidate events above an arbitrary threshold (option <code>-threshold</code> for the <span class="arithmatex"><span class="MathJax_Preview">\mathcal{F}</span><script type="math/tex">\mathcal{F}</script></span>-statistic, default 20), are written to the <code>output_dir</code> directory. There are two output files for every input data sequence: <code>triggers_nnn_bbbb_1.bin</code> and
<code>triggers_nnn_bbbb_2.bin</code>,  where  <code>1</code> and  <code>2</code> correspond to the northern and southern ecliptic hemisphere. Each trigger (candidate) event occupies <code>40</code> consecutive bytes (5 double numbers), with the following meaning:</p>
<p>Record no.            | 
--------------------- | ---------------------------- 
1                     | frequency [radians, between 0 and <span class="arithmatex"><span class="MathJax_Preview">\pi</span><script type="math/tex">\pi</script></span>] above <code>fpo</code><br />
2                     | spindown [<span class="arithmatex"><span class="MathJax_Preview">\mathrm{Hz/s}</span><script type="math/tex">\mathrm{Hz/s}</script></span>]<br />
3                     | declination [radians, between <span class="arithmatex"><span class="MathJax_Preview">\pi/2</span><script type="math/tex">\pi/2</script></span> and <span class="arithmatex"><span class="MathJax_Preview">-\pi/2</span><script type="math/tex">-\pi/2</script></span>]
4                     | right ascension [radians, between 0 and <span class="arithmatex"><span class="MathJax_Preview">2\pi</span><script type="math/tex">2\pi</script></span>]
5                     | signal-to-noise ratio</p>
<p>For the example above, the first 10 triggers from <code>triggers_001_1234_2.bin</code> are </p>
<pre><code class="language-bash">3.05617018e+00 -3.42376198e-08 -7.68007347e-02 2.59248668e+00 5.06667333e+00 
1.18243015e+00 -3.20762991e-08 -7.68007347e-02 2.59248668e+00 5.05528873e+00 
1.08103361e-01 -2.77536578e-08 -7.68007347e-02 2.59248668e+00 5.07085254e+00 
1.90022435e+00 -2.77536578e-08 -7.68007347e-02 2.59248668e+00 5.15191593e+00 
1.90000217e+00 -2.55923371e-08 -7.68007347e-02 2.59248668e+00 5.42638039e+00 
2.09224664e+00 -2.34310165e-08 -7.68007347e-02 2.59248668e+00 5.20879551e+00 
2.38731576e+00 -2.12696958e-08 -7.68007347e-02 2.59248668e+00 5.31983396e+00 
3.00543165e+00 -1.91083751e-08 -7.68007347e-02 2.59248668e+00 5.29454616e+00 
7.49333983e-01 -1.26244131e-08 -7.68007347e-02 2.59248668e+00 5.08724856e+00 
2.08710778e-01  3.43510887e-10 -7.68007347e-02 2.59248668e+00 5.17537018e+00 
</code></pre>
<h3 id="auxiliary-output-files">Auxiliary output files</h3>
<ul>
<li>
<p><code>wisdom-hostname.dat</code> - performance-testing file created by the <code>FFTW</code>. The <code>hostname</code> variable is determined by a call to <code>gethostname()</code>, </p>
</li>
<li>
<p><code>state_nnn_bbbb.dat</code> - checkpointing file containing the last grid point visited. The search can  be safely restarted, calculations will continue  from the last grid position saved to this file. After successful termination, checkpoint file is left empty.</p>
</li>
</ul>
              
            </div>
          </div><footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="Footer Navigation">
        <a href="../grid_generation/" class="btn btn-neutral float-left" title="Grid generation"><span class="icon icon-circle-arrow-left"></span> Previous</a>
        <a href="../coincidences/" class="btn btn-neutral float-right" title="Coincidences between candidates">Next <span class="icon icon-circle-arrow-right"></span></a>
    </div>

  <hr/>

  <div role="contentinfo">
    <!-- Copyright etc -->
  </div>

  Built with <a href="https://www.mkdocs.org/">MkDocs</a> using a <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a> provided by <a href="https://readthedocs.org">Read the Docs</a>.
</footer>
          
        </div>
      </div>

    </section>

  </div>

  <div class="rst-versions" role="note" aria-label="Versions">
  <span class="rst-current-version" data-toggle="rst-current-version">
    
    
      <span><a href="../grid_generation/" style="color: #fcfcfc">&laquo; Previous</a></span>
    
    
      <span><a href="../coincidences/" style="color: #fcfcfc">Next &raquo;</a></span>
    
  </span>
</div>
    <script src="../js/jquery-3.6.0.min.js"></script>
    <script>var base_url = "..";</script>
    <script src="../js/theme_extra.js"></script>
    <script src="../js/theme.js"></script>
      <script src="../javascripts/highlight.js"></script>
      <script src="../javascripts/mathjax.js"></script>
      <script src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-chtml.js"></script>
      <script src="../search/main.js"></script>
    <script>
        jQuery(function () {
            SphinxRtdTheme.Navigation.enable(true);
        });
    </script>

</body>
</html>
